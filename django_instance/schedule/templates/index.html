{% load static %}
<html>
    <head>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
        <script type="module" src={% static "listeners.js"%}></script>
        <script type="module" src={% static "functionality.js"%}></script>

    </head>
    <body>
        <div  id="main"
            x-data="{ projects: [] }"
            x-init="projects = await (await fetch('/api/projects')).json()"
        >
        <template x-for="project in projects">
            <div>
                <header>
                    <p class="h2" x-text="project.name"></p>
                    <form x-bind:action="'api/projects/'+project.id+'/tasks/create'" method="POST" >
                        <input type="text" name="description" placeholder="Start typing here to create a task">
                        <button type='submit'>Add Task</button>
                    </form>
                </header>
                    
                <table
                    x-data = "{ tasks: []}"
                    x-init="tasks = await (await fetch('api/projects/'+project.id+'/tasks/create')).json()"
                >
                <template x-for="task in tasks">
                    <tr x-data = "{checkbox_id: 'p'+project.id+'.t'+task.id}">
                        <td>
                            <input type="checkbox" name="" x-bind:id="checkbox_id">
                        </td>
                        <td>
                            <label x-bind:for="checkbox_id" x-text="task.description"></label>
                        </td>

                    </tr>
                </template>
                
                </table>


            </div>
        </template>
            
        </div>
    </body>
</html>